# MotionAI 
[![openupm](https://img.shields.io/npm/v/com.evomo.motionai?label=openupm&registry_uri=https://package.openupm.com)](https://openupm.com/packages/com.evomo.motionai/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)


## Register for license key
To use our SDK a license key is required which is generated after a short registration and your acceptance of the [license terms].

[<Highlight color="#FF8E34">**--> Register to get the license key**</Highlight>](https://subscriptions.zoho.eu/subscribe/a86776477592bad75f6bc8765d4c5c76a57851cb64dfe979651bdda4a1c7d344/beta)

Our beta-sdk is actually completely free for non commercial usage/testing. See details in the [license terms]. 

>Please contact us for commercial use. info@evomo.de 

[license terms]: https://www.evomo.de/license-agreement

---

## Requirements

- The EvomoUnitySDK is currently only available for iOS.
- The EvomoUnitySDK requires a minimum Xcode 11.4 with Swift 5.2
- The EvomoUnitySDK requires a minimum iOS target of 12.1.
- The EvomoUnitySDK only supports 64 bit builds.


## Install 
We recommend using the OpenUPM to install it by running:
```
openupm add com.evomo.motionai
```


But if you wish to use it without  installing an external dependency you can add the scope and dependencies using: 


```

{
  "scopedRegistries": [
    {
      "name": "package.openupm.com",
      "url": "https://package.openupm.com",
      "scopes": [
        "com.solidalloy.type.references",
        "com.evomo.motionai",
        "com.openupm"
      ]
    }
  ],
  "dependencies": {
    "com.evomo.motionai": "[Latest-Release-Version]"
  }
}
```


# Quick Setup

1. Register for a license key
2. Create an [SDK License Asset](https://github.com/Evomo/unityMotionAIPlugin/blob/master/Assets/MotionAI/Core/POCO/SDKConfig.cs) Create an SDK by clicking on `Evomo -> MotionAI -> Create SDK Settings` and add your license key. 
3. Place MotionAIManager component in your scene and reference the SDKSettings you created.
4. Attach the [MotionAIController](https://github.com/Evomo/unityMotionAIPlugin/blob/master/Assets/MotionAI/Core/Controller/MotionAIController.cs) component to your player.
5. Choose a model that you wish to track inside the MotionAIController editor
6. Subscribe to the events in the "Tracked Moves" object inside the Controller


# Important Components


## **[MotionAIManager](https://github.com/Evomo/unityMotionAIPlugin/blob/master/Assets/MotionAI/Core/Controller/MotionAIManager.cs)**

This component handles the communication with the inference engine Native SDK, handles the controller pairing and propagates the acquired messages to the registered controllers. 


If automatic pairing is checked the controllers found in the scene are registered to the manager. 


## **[MotionAIController](https://github.com/Evomo/unityMotionAIPlugin/blob/master/Assets/MotionAI/Core/Controller/MotionAIController.cs)**
This component reacts to the messages and dispatches different events depending on the given movement performed. It can be used with the stock component or override ([for example](https://github.com/Evomo/unityMotionAIPlugin/blob/master/Assets/MotionAI/Samples/CoreDemo/ModelEventController.cs)). 

There are multiple ways to react to the events. You can directly reference the used model component as shown in the example above, but all the event handling can also be done through the editor by accessing the "Tracked Moves" object inside the editor and subscribing to the desired move.






## **Models** 
These represent a usable container inside of Unity with the metadata of different trained neural networks. 
They are autogenerated and are read only. You should only initialize these components via a dropdown in the Model Manager class inside the MotionAIController component. 


The models are representations of the tracked movements with their events, these are exposed in the MotionAIController in the Tracked Moves class. 

**Model Type** defines if you would like to track Full Movements(**Fitness**) or Elmos(**Gaming**).
Full movements are a collection of succesive Elemental Movements (Elmos for short) performed in a certain order. 

A full list of the available movements and elmos can be found [here](https://github.com/Evomo/unityMotionAIPlugin/blob/master/Assets/MotionAI/Core/Models/Generated/Constants.cs)

Feel free to explore the different models found in [the models folder](https://github.com/Evomo/unityMotionAIPlugin/tree/master/Assets/MotionAI/Core/Models/Generated) to get a better understanding of which moves/elmos are present in each model. 

## **[MotionAIControlDebugger](https://github.com/Evomo/unityMotionAIPlugin/blob/master/Assets/MotionAI/Core/Controller/DebugMovement/MotionAIControlDebugger.cs)**

The ControlDebugger is an interface to send debug movements with a delay and play your games in the editor.
An [EvoDebugInputAsset](https://github.com/Evomo/unityMotionAIPlugin/blob/master/Assets/MotionAI/Core/Controller/DebugMovement/EvoInputDebugAsset.cs) Scriptable Object (`Evomo -> MotionAI -> InputDebugAssets`) is used to map the keyboard keys to the the desired movement and/or the controller device ID. 

This is placed in the object which contains a MotionAIController



## Examples


Further examples can be found in the samples of the package or in the following prototypes:

- [Turn Based](https://github.com/Evomo/TurnBased-Prototype)
  - Shows how to use the SDK in a turn based game by [overriding](https://github.com/Evomo/TurnBased-Prototype/blob/main/Assets/Scripts/SlipAndJump/PlayerController.cs) the MotionAIController

- [Infinite Runner](https://github.com/Evomo/Ball-Prototype)
  - Also [overrides](https://github.com/Evomo/Ball-Prototype/blob/master/Assets/Scripts/Character/ElmoSlimeController.cs) the Controller class but reacts to the Elemental Movements instead of the complete Movements


## Building

### 1: Export/Build the xcode project from unity. 

Be sure to set the minimum iOS version to 12.1 and the supported arch to ARM64 only in your unity player settings before exporting.

### Cocoa Pods

#### 2: Install Cocoa Pods on your Mac

```
sudo gem install cocoapods
```

#### 3.1: Install pods

Navigate to the project folder and run **pod install** on the console. From then on use the generated project workspace and you should be good to go.

This process only needs to be done the first time you export from unity. For following builds you can use the 'append' option.

If you use the replace option then you will need to follow these steps again.

#### 3.2: Optional: Update Evomo SDK 

Upgrade the evomo cocoa pod if needed with the shell command **pod update** in your Xcode project folder.

Then go into the Xcode workspace and **clean** the project build folder with: Product > Clean Build Folder


#### Optional: Add the Evomo cocoa pod file manually (normally it will be automatically created after building)

Run pod init in the project and add the following cocoa pod to the targets of your pod file:

```
pod 'EvomoUnitySDK'
```

Add an extra source to the top of the podfile:

```
# Evomo private specs repo source
source 'https://bitbucket.org/evomo/evomopodsrelease.git'
```

**IMPORTANT NOTE:** 

Once again you must check if you have a target named 'UnityFramework' and if so add the pod to that target only. If you do not have that target in your podfile then you should add the pod to the target named 'Unity-iPhone' only. 

**Example Podfile:**
```
# Evomo private specs repo source
source 'https://bitbucket.org/evomo/evomopodsrelease.git'

# Standard cocoapods specs source
source 'https://github.com/CocoaPods/Specs.git'

# Uncomment the next line to define a global platform for your project
platform :ios, '12.1'

target 'EvomoUnitySDK' do
  # Comment the next line if you don't want to use dynamic frameworks
  use_frameworks!
	
  pod "EvomoMotionAI/Basic"

  # Pods for EvomoUnitySDK
end

```

### Hint

To avoid manual inputs in Apple App Store Connect setup the encryption config.

Unless your app is using some special encryption you can simply add Boolean a key to your Info.plist with name ITSAppUsesNonExemptEncryption and value NO.
